<!DOCTYPE html>
<html lang="en">
<head>
    <!--Para que Google no indexe este index-->
    <meta name="googlebot" content="noindex" />
    <meta name="googlebot-news" content="nosnippet" />
    <meta name="robots" content="noindex, nofollow" />
    <!---->

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="./css/style.css?v1">
    <link rel="stylesheet" href="https://d1ts5g4ys243sh.cloudfront.net/proyectos_especiales_prod/especiales-multimedia/puerto-de-chancay/css/examples.css?v4">


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=Noto+Serif+Display:ital,wght@0,100..900;1,100..900&family=Noto+Serif+KR:wght@200..900&family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"> 

    <style>
        
        #gpt_zocalo, 
        #clever-45754-sticky-footer-shadow,
        #browsi_wrapper_0_ai_1_rc_0,
        #browsi_wrapper_1_ai_1_rc_0,
        #browsi_wrapper_2_ai_1_rc_0,
        #browsi_wrapper_3_ai_1_rc_0,
        #browsi_wrapper_4_ai_1_rc_0,
        #browsi_wrapper_5_ai_1_rc_0,
        #browsi_wrapper_6_ai_1_rc_0,
        #browsi_wrapper_7_ai_1_rc_0,
        #browsi_wrapper_8_ai_1_rc_0,
        #browsi_wrapper_9_ai_1_rc_0,
        #browsi_wrapper_10_ai_1_rc_0{
            display: none !important;
            height: 0 !important;
        }  
        .nav-d__main-scroll.scrolled{
            z-index: 9999;
        }
    </style>

</head>
<body>
    
    <div class="main">
        
        <div id="social">
            <button id="fb" class="sharer button" data-sharer="facebook" data-hashtag="" data-url="">Facebook</button>
    
            <button id="wst" class="sharer button" data-sharer="whatsapp" data-title="DT | El Comercio" data-url="#">Whatsapp</button>
    
            <button id="tw" class="sharer button" data-sharer="twitter" data-title="DT | El Comercio" data-hashtags="" data-via="elcomercio_peru" data-url="#">Twitter</button>
        </div>

        <div class="main-portada">            
            <div class="btn-intro">
                <p>sumérgete con sofi</p>
            </div>
            <video id="portada" src="./video/portada.mp4" width="100%" muted autoplay loop playsinline></video>
            <video id="portada-movil" src="./video/portada-movil.mp4" width="100%" muted autoplay loop playsinline></video>
        </div>       

        <div class="box-bajada">
            <h1>reina <span>del surf peruano</span></h1>
            <p>
                <span>Sofía mulanovich,</span> La primera peruana en lograr un título mundial de surf merece su propio especial, 20 años después estas son sus historias.
            </p>
        </div>    

        <p class="ctn-texto">
            Lorem ipsum dolor sit amet consectetur adipiscing elit tincidunt lacus, magna mauris sociis Lorem ipsum dolor sit amet consectetur adipiscing elit tincidunt lacus, magna mauris sociis augue non mi senectus dictum, in ridiculus rutrum vitae varius eleifend egestas vivamus. <span>Nisl nceptos facilisis odio conubia.</span>i
        </p>

        <div class="box-menu">
            <div class="box-indicacion-menu">
                <img src="./img/icon-mano.png" alt="" width="100%">
                <p>Selecciona una Sofi</p>
            </div>
            <ul>
                <li>
                    <img class="bg-menu-desktop" src="./img/bg-menu-1.webp" alt="" width="100%">
                    <img class="bg-menu-movil" src="./img/bg-menu-1-movil.webp" alt="" width="100%">
                    <p>2024</p>
                </li>
                <li>
                    <img class="bg-menu-desktop" src="./img/bg-menu-2.webp" alt="" width="100%">
                    <img class="bg-menu-movil" src="./img/bg-menu-2-movil.webp" alt="" width="100%">
                    <p>2020</p>
                </li>
                <li>
                    <img class="bg-menu-desktop" src="./img/bg-menu-3.webp" alt="" width="100%">
                    <img class="bg-menu-movil" src="./img/bg-menu-3-movil.webp" alt="" width="100%">
                    <p>2004</p>
                </li>
                <li>
                    <img class="bg-menu-desktop" src="./img/bg-menu-4.webp" alt="" width="100%">
                    <img class="bg-menu-movil" src="./img/bg-menu-4-movil.webp" alt="" width="100%">
                    <p>1997</p>
                </li>
                <li>
                    <img class="bg-menu-desktop" src="./img/bg-menu-5.webp" alt="" width="100%">
                    <img class="bg-menu-movil" src="./img/bg-menu-5-movil.webp" alt="" width="100%">
                    <p>1992</p>
                </li>
            </ul>
        </div>

        <div class="box-horizontal scrollable" id="box-horizontal-3">
            <div class="ctn-box-horizontal">
                <div class="box-ctn-titular">
                    <h3>sofía campeona mundial por primera vez</h3>
                    <img src="./img/icon-deslizar.png" alt="" width="100%">
                    <h4>2004</h4>
                </div>
                <img src="./img/bg-mar.webp" alt="" width="100%" class="mar">
                <img src="./img/sofia-2004.webp" alt="" width="100%" class="sofia-2004">
                <div class="box-contenido">
                    <div class="box-iframe">
                        <div style="position:relative;overflow:hidden;padding-bottom:177.78%">
                            <iframe id="iframe1" data-manage-visibility src="https://cdn.jwplayer.com/players/2DfYVa3r-sfGpVx0W.html" width="100%" height="100%" frameborder="0" scrolling="auto" title="Melisa Evanan " style="position:absolute;" allowfullscreen></iframe>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>


        <!--<div class="box-footer">
            <div class="box-ctn-footer">
                <img src="https://d1ts5g4ys243sh.cloudfront.net/proyectos_especiales_prod/especiales-multimedia/susana-baca/img/logo-comercio.png" alt="el comercio" width="100%">
                <ul class="creditos">
                    <li>
                        Textos:
                        <span>Ángel Navarro</span>
                    </li>
                    <li>
                        Ilustraciones:
                        <span>Kiomy Kanashiro</span>
                    </li>
                    <li>
                        Realización:
                        <span>Nuevas Narrativas El Comercio</span>
                    </li>
                </ul>
            </div>
        </div>-->       

    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>   
    <script src="https://d1ts5g4ys243sh.cloudfront.net/proyectos_especiales_prod/especiales/el-metro-interminable-ecpm/js/ScrollMagic.min.js"></script>
    <script src="https://d1ts5g4ys243sh.cloudfront.net/proyectos_especiales_prod/especiales-multimedia/puerto-de-chancay/js/TweenMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://d1ts5g4ys243sh.cloudfront.net/proyectos_especiales_prod/especiales-multimedia/puerto-de-chancay/js/animation.gsap.js"></script>


    <!-- compartir -->
    <script>
        function shareUrl(event) {
            const button = event.target;
            const url = button.getAttribute('data-url');
            
            const sharer = button.getAttribute('data-sharer');
            let shareUrl = '';

            switch (sharer) {
            case 'facebook':
                const fbHashtag = button.getAttribute('data-hashtag') || '';
                shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&hashtag=${encodeURIComponent(fbHashtag)}`;
                break;
                
            case 'whatsapp':
                const whatsappTitle = button.getAttribute('data-title');
                shareUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(whatsappTitle + ' ' + url)}`;
                break;
                
            case 'twitter':
                const twitterTitle = button.getAttribute('data-title');
                const twitterHashtags = button.getAttribute('data-hashtags');
                const twitterVia = button.getAttribute('data-via');
                shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(twitterTitle)}&url=${encodeURIComponent(url)}&hashtags=${twitterHashtags}&via=${twitterVia}`;
                break;
            }

            window.open(shareUrl, '_blank');
        }

        document.querySelectorAll('.sharer').forEach(button => {
            button.addEventListener('click', shareUrl);
        });
    </script>

    <!-- flecha bajar -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const flechaBajar = document.querySelector('.btn-intro');
            const boxBajada = document.querySelector('.box-bajada');

            flechaBajar.addEventListener('click', function () {
                boxBajada.scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>
    
    <!-- animaciones elementos -->
    <script>

        // mar
        var controller = new ScrollMagic.Controller();       
        new ScrollMagic.Scene({
            triggerElement: ".box-horizontal",
            triggerHook: 0.5,
        })
            .on("enter", function(event) {
                $(".mar").addClass("enterMar"); 
                $(".mar").removeClass("salirMar"); 
            })
            .on("leave", function(event) {
                $(".mar").addClass("salirMar"); 
                $(".mar").removeClass("enterMar"); 
            })
            .addTo(controller);     
            
        // sofia 2004
        var controller = new ScrollMagic.Controller();       
        new ScrollMagic.Scene({
            triggerElement: ".box-horizontal",
            triggerHook: 0.5,
        })
            .on("enter", function(event) {
                $(".sofia-2004").addClass("enterSofia2004"); 
                $(".sofia-2004").removeClass("salirSofia2004"); 
            })
            .on("leave", function(event) {
                $(".sofia-2004").addClass("salirSofia2004"); 
                $(".sofia-2004").removeClass("enterSofia2004"); 
            })
            .addTo(controller);    

    </script> 

    <!-- scroleable -->
    <script>
        const scrollableDivs = document.querySelectorAll(".scrollable");

        scrollableDivs.forEach((scrollableDiv) => {
            let isDown = false;
            let startX;
            let scrollLeft;

            scrollableDiv.addEventListener("mousedown", (e) => {
                isDown = true;
                startX = e.pageX - scrollableDiv.offsetLeft;
                scrollLeft = scrollableDiv.scrollLeft;
            });

            scrollableDiv.addEventListener("mouseleave", () => {
                isDown = false;
            });

            scrollableDiv.addEventListener("mouseup", () => {
                isDown = false;
            });

            scrollableDiv.addEventListener("mousemove", (e) => {
                if (!isDown) return;
                e.preventDefault();
                const x = e.pageX - scrollableDiv.offsetLeft;
                const walk = (x - startX) * 2; // velocidad de desplazamiento
                scrollableDiv.scrollLeft = scrollLeft - walk;
            });
        });
    </script>

    <!-- pausa video iframe -->
    <script>
        // Clase para manejar la visibilidad de los iframes
        class IframeManager {
            constructor(selector = 'iframe[data-manage-visibility]') {
                this.selector = selector;
                this.observers = new Map();
                this.init();
            }

            init() {
                // Inicializar todos los iframes existentes
                const iframes = document.querySelectorAll(this.selector);
                iframes.forEach(iframe => this.setupIframe(iframe));

                // Observar cambios en el DOM para nuevos iframes
                this.setupMutationObserver();

                // Manejar resize de ventana
                this.setupResizeHandler();
            }

            setupIframe(iframe) {
                const container = iframe.closest('.box-horizontal');
                
                // Configuración del IntersectionObserver
                const options = {
                    root: null,
                    rootMargin: '0px',
                    threshold: [0.3],
                };

                // Crear y guardar el observer para este iframe específico
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (!entry.isIntersecting) {
                            this.pauseIframeContent(iframe);
                            console.log(`Iframe ${iframe.id || 'sin ID'} fuera de vista - contenido pausado`);
                        } else {
                            this.resumeIframeContent(iframe);
                            console.log(`Iframe ${iframe.id || 'sin ID'} visible - contenido resumido`);
                        }
                    });
                }, options);

                // Guardar el observer en el Map
                this.observers.set(iframe, observer);
                observer.observe(iframe);

                // Configurar scroll horizontal si existe el contenedor
                if (container) {
                    this.setupHorizontalScroll(iframe, container);
                }
            }

            setupHorizontalScroll(iframe, container) {
                const scrollHandler = () => {
                    const rect = iframe.getBoundingClientRect();
                    const containerRect = container.getBoundingClientRect();
                    
                    const isOutOfHorizontalView = 
                        rect.left > containerRect.right ||
                        rect.right < containerRect.left;

                    if (isOutOfHorizontalView) {
                        this.pauseIframeContent(iframe);
                        console.log(`Iframe ${iframe.id || 'sin ID'} fuera de vista horizontal - contenido pausado`);
                    } else if (document.contains(iframe)) {
                        this.resumeIframeContent(iframe);
                        console.log(`Iframe ${iframe.id || 'sin ID'} dentro de vista horizontal - contenido resumido`);
                    }
                };

                container.addEventListener('scroll', scrollHandler, { passive: true });
                
                // Guardar el handler para poder removerlo si es necesario
                iframe.dataset.scrollHandler = scrollHandler;
            }

            setupMutationObserver() {
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach(mutation => {
                        mutation.addedNodes.forEach(node => {
                            if (node.nodeType === 1 && node.matches?.(this.selector)) {
                                this.setupIframe(node);
                            }
                        });
                        
                        mutation.removedNodes.forEach(node => {
                            if (node.nodeType === 1 && node.matches?.(this.selector)) {
                                this.cleanupIframe(node);
                            }
                        });
                    });
                });

                observer.observe(document.body, {
                    childList: true,
                    subtree: true
                });
            }

            setupResizeHandler() {
                let resizeTimeout;
                window.addEventListener('resize', () => {
                    clearTimeout(resizeTimeout);
                    resizeTimeout = setTimeout(() => {
                        document.querySelectorAll(this.selector).forEach(iframe => {
                            if (document.contains(iframe)) {
                                this.observers.get(iframe)?.disconnect();
                                this.setupIframe(iframe);
                            }
                        });
                    }, 250);
                }, { passive: true });
            }

            pauseIframeContent(iframe) {
                try {
                    if (!iframe.dataset.originalSrc && iframe.src !== 'about:blank') {
                        iframe.dataset.originalSrc = iframe.src;
                    }

                    if (iframe.src.includes('youtube.com')) {
                        iframe.contentWindow?.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
                    }
                    
                    if (iframe.src !== 'about:blank' && !iframe.src.includes('youtube.com')) {
                        iframe.src = 'about:blank';
                    }
                } catch (error) {
                    console.error(`Error al pausar iframe ${iframe.id || 'sin ID'}:`, error);
                }
            }

            resumeIframeContent(iframe) {
                try {
                    if (iframe.dataset.originalSrc && iframe.src === 'about:blank') {
                        iframe.src = iframe.dataset.originalSrc;
                    }
                } catch (error) {
                    console.error(`Error al reanudar iframe ${iframe.id || 'sin ID'}:`, error);
                }
            }

            cleanupIframe(iframe) {
                // Limpiar el observer
                const observer = this.observers.get(iframe);
                if (observer) {
                    observer.disconnect();
                    this.observers.delete(iframe);
                }
            }
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            // Crear instancia del manejador de iframes
            window.iframeManager = new IframeManager();
        });

    </script>

</body>
</html>